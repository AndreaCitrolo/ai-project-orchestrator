#!/usr/bin/env claude-command
# Generate Tasks
# Usage: generate-tasks [initiative-dir]

## READ CONTEXT

MUST read:
1. `initiatives/[initiative-dir]/description.prd`
2. `project-state.prd` (referenced modules)

## GENERATE TASK GROUPS

Group 0: ALWAYS prerequisites (env, db, config)
Groups 1+: By dependency layers

**Grouping Rules (ENFORCE):**
- Models BEFORE services using them
- Services BEFORE APIs using them
- APIs BEFORE UI using them
- FK model AFTER referenced model
- UI with mocking = same group as API (add integration task later)
- 3-5 tasks per group (optimal parallelism)

## TASK FORMAT

```markdown
# Tasks: [Initiative Name]

**Initiative**: [NNNN]-[status]-[name]
**Generated**: [YYYY-MM-DD]

## Task Group 0: Prerequisites

MUST complete before other groups.

- [ ] TASK-001: [Description]
  Dependencies: None
  Est: Xh

- [ ] TASK-002: [Description]
  Dependencies: None
  Est: Xh

## Task Group 1: [Name]

- [ ] TASK-003: [Description]
  Dependencies: TASK-001, TASK-002
  Est: Xh

- [ ] TASK-004: [Description]
  Dependencies: TASK-002
  Est: Xh

[Continue...]

## Cross-Initiative Dependencies

IF depends on other initiatives, document:
- TASK-XXX depends on: NNNN-[status]-[name]/TASK-YYY
```

## MANDATORY TASK TYPES

MUST include (based on PRD):
- [ ] Group 0: Setup/config tasks
- [ ] Data/Model tasks
- [ ] Logic/Service tasks
- [ ] API/Interface tasks
- [ ] Testing tasks (per testing strategy)
- [ ] Deployment task (if deployment != manual)

## CREATE: tasks.prd

File: `initiatives/[initiative-dir]/tasks.prd`

Write generated tasks.

## UPDATE: status.prd

Add to status.prd:
```
Tasks: X tasks in Y groups
Generated: [YYYY-MM-DD]
```

## VALIDATION

MUST verify:
- [ ] Group 0 exists
- [ ] Dependencies correct (no forward refs within group)
- [ ] Cross-initiative deps documented
- [ ] 3-5 tasks per group (except Group 0)
- [ ] Testing tasks present
- [ ] Time estimates present
- [ ] Total tasks: 15-50 range (adjust if outside)

## OUTPUT

```
Tasks: X tasks in Y groups
File: initiatives/[initiative-dir]/tasks.prd
Next: Rename to [NNNN]-active-[name], then start-task
```
